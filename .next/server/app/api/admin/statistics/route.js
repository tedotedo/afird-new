"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/admin/statistics/route";
exports.ids = ["app/api/admin/statistics/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fadmin%2Fstatistics%2Froute&page=%2Fapi%2Fadmin%2Fstatistics%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fadmin%2Fstatistics%2Froute.ts&appDir=%2FUsers%2Fodet%2Fwebsites%2FAFIRD-new%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fodet%2Fwebsites%2FAFIRD-new&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fadmin%2Fstatistics%2Froute&page=%2Fapi%2Fadmin%2Fstatistics%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fadmin%2Fstatistics%2Froute.ts&appDir=%2FUsers%2Fodet%2Fwebsites%2FAFIRD-new%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fodet%2Fwebsites%2FAFIRD-new&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _Users_odet_websites_AFIRD_new_src_app_api_admin_statistics_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/app/api/admin/statistics/route.ts */ \"(rsc)/./src/app/api/admin/statistics/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/admin/statistics/route\",\n        pathname: \"/api/admin/statistics\",\n        filename: \"route\",\n        bundlePath: \"app/api/admin/statistics/route\"\n    },\n    resolvedPagePath: \"/Users/odet/websites/AFIRD-new/src/app/api/admin/statistics/route.ts\",\n    nextConfigOutput,\n    userland: _Users_odet_websites_AFIRD_new_src_app_api_admin_statistics_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/admin/statistics/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZhZG1pbiUyRnN0YXRpc3RpY3MlMkZyb3V0ZSZwYWdlPSUyRmFwaSUyRmFkbWluJTJGc3RhdGlzdGljcyUyRnJvdXRlJmFwcFBhdGhzPSZwYWdlUGF0aD1wcml2YXRlLW5leHQtYXBwLWRpciUyRmFwaSUyRmFkbWluJTJGc3RhdGlzdGljcyUyRnJvdXRlLnRzJmFwcERpcj0lMkZVc2VycyUyRm9kZXQlMkZ3ZWJzaXRlcyUyRkFGSVJELW5ldyUyRnNyYyUyRmFwcCZwYWdlRXh0ZW5zaW9ucz10c3gmcGFnZUV4dGVuc2lvbnM9dHMmcGFnZUV4dGVuc2lvbnM9anN4JnBhZ2VFeHRlbnNpb25zPWpzJnJvb3REaXI9JTJGVXNlcnMlMkZvZGV0JTJGd2Vic2l0ZXMlMkZBRklSRC1uZXcmaXNEZXY9dHJ1ZSZ0c2NvbmZpZ1BhdGg9dHNjb25maWcuanNvbiZiYXNlUGF0aD0mYXNzZXRQcmVmaXg9Jm5leHRDb25maWdPdXRwdXQ9JnByZWZlcnJlZFJlZ2lvbj0mbWlkZGxld2FyZUNvbmZpZz1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNjO0FBQ29CO0FBQ2pHO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixnSEFBbUI7QUFDM0M7QUFDQSxjQUFjLHlFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxZQUFZO0FBQ1osQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLFFBQVEsaUVBQWlFO0FBQ3pFO0FBQ0E7QUFDQSxXQUFXLDRFQUFXO0FBQ3RCO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDdUg7O0FBRXZIIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYWZpcmQtZm9vZC10cmFja2VyLz8xYTJiIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFwcFJvdXRlUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9hcHAtcm91dGUvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgcGF0Y2hGZXRjaCBhcyBfcGF0Y2hGZXRjaCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi9wYXRjaC1mZXRjaFwiO1xuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIi9Vc2Vycy9vZGV0L3dlYnNpdGVzL0FGSVJELW5ldy9zcmMvYXBwL2FwaS9hZG1pbi9zdGF0aXN0aWNzL3JvdXRlLnRzXCI7XG4vLyBXZSBpbmplY3QgdGhlIG5leHRDb25maWdPdXRwdXQgaGVyZSBzbyB0aGF0IHdlIGNhbiB1c2UgdGhlbSBpbiB0aGUgcm91dGVcbi8vIG1vZHVsZS5cbmNvbnN0IG5leHRDb25maWdPdXRwdXQgPSBcIlwiXG5jb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBBcHBSb3V0ZVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5BUFBfUk9VVEUsXG4gICAgICAgIHBhZ2U6IFwiL2FwaS9hZG1pbi9zdGF0aXN0aWNzL3JvdXRlXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvYWRtaW4vc3RhdGlzdGljc1wiLFxuICAgICAgICBmaWxlbmFtZTogXCJyb3V0ZVwiLFxuICAgICAgICBidW5kbGVQYXRoOiBcImFwcC9hcGkvYWRtaW4vc3RhdGlzdGljcy9yb3V0ZVwiXG4gICAgfSxcbiAgICByZXNvbHZlZFBhZ2VQYXRoOiBcIi9Vc2Vycy9vZGV0L3dlYnNpdGVzL0FGSVJELW5ldy9zcmMvYXBwL2FwaS9hZG1pbi9zdGF0aXN0aWNzL3JvdXRlLnRzXCIsXG4gICAgbmV4dENvbmZpZ091dHB1dCxcbiAgICB1c2VybGFuZFxufSk7XG4vLyBQdWxsIG91dCB0aGUgZXhwb3J0cyB0aGF0IHdlIG5lZWQgdG8gZXhwb3NlIGZyb20gdGhlIG1vZHVsZS4gVGhpcyBzaG91bGRcbi8vIGJlIGVsaW1pbmF0ZWQgd2hlbiB3ZSd2ZSBtb3ZlZCB0aGUgb3RoZXIgcm91dGVzIHRvIHRoZSBuZXcgZm9ybWF0LiBUaGVzZVxuLy8gYXJlIHVzZWQgdG8gaG9vayBpbnRvIHRoZSByb3V0ZS5cbmNvbnN0IHsgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MgfSA9IHJvdXRlTW9kdWxlO1xuY29uc3Qgb3JpZ2luYWxQYXRobmFtZSA9IFwiL2FwaS9hZG1pbi9zdGF0aXN0aWNzL3JvdXRlXCI7XG5mdW5jdGlvbiBwYXRjaEZldGNoKCkge1xuICAgIHJldHVybiBfcGF0Y2hGZXRjaCh7XG4gICAgICAgIHNlcnZlckhvb2tzLFxuICAgICAgICBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlXG4gICAgfSk7XG59XG5leHBvcnQgeyByb3V0ZU1vZHVsZSwgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MsIG9yaWdpbmFsUGF0aG5hbWUsIHBhdGNoRmV0Y2gsICB9O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1hcHAtcm91dGUuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fadmin%2Fstatistics%2Froute&page=%2Fapi%2Fadmin%2Fstatistics%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fadmin%2Fstatistics%2Froute.ts&appDir=%2FUsers%2Fodet%2Fwebsites%2FAFIRD-new%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fodet%2Fwebsites%2FAFIRD-new&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./src/app/api/admin/statistics/route.ts":
/*!***********************************************!*\
  !*** ./src/app/api/admin/statistics/route.ts ***!
  \***********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET)\n/* harmony export */ });\n/* harmony import */ var _lib_supabase_admin__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/lib/supabase/admin */ \"(rsc)/./src/lib/supabase/admin.ts\");\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n\n\n/**\n * Admin statistics API endpoint\n * Returns aggregated anonymized statistics across all users\n * Protected by ADMIN_API_KEY environment variable\n */ async function GET(request) {\n    try {\n        // Check for admin API key\n        const authHeader = request.headers.get(\"authorization\");\n        const adminApiKey = process.env.ADMIN_API_KEY;\n        if (!adminApiKey) {\n            return next_server__WEBPACK_IMPORTED_MODULE_1__.NextResponse.json({\n                error: \"Admin API key not configured\"\n            }, {\n                status: 500\n            });\n        }\n        // Verify admin API key\n        if (!authHeader || authHeader !== `Bearer ${adminApiKey}`) {\n            return next_server__WEBPACK_IMPORTED_MODULE_1__.NextResponse.json({\n                error: \"Unauthorized - Invalid admin API key\"\n            }, {\n                status: 401\n            });\n        }\n        const supabase = (0,_lib_supabase_admin__WEBPACK_IMPORTED_MODULE_0__.createAdminClient)();\n        // Query 1: Daily aggregated stats (anonymized)\n        const { data: dailyStats, error: dailyError } = await supabase.rpc(\"get_daily_stats\");\n        // If RPC doesn't exist, use direct query\n        let dailyAggregatedStats;\n        if (dailyError) {\n            const { data, error } = await supabase.from(\"food_entries\").select(\"date_time, nutritional_data, user_id\");\n            if (error) throw error;\n            // Process in memory (for smaller datasets)\n            const statsByDate = new Map();\n            data?.forEach((entry)=>{\n                const date = new Date(entry.date_time).toISOString().split(\"T\")[0];\n                const calories = parseFloat(entry.nutritional_data?.calories || \"0\");\n                if (!statsByDate.has(date)) {\n                    statsByDate.set(date, {\n                        date,\n                        total_entries: 0,\n                        unique_users: new Set(),\n                        total_calories: 0,\n                        entry_count: 0\n                    });\n                }\n                const stat = statsByDate.get(date);\n                stat.total_entries++;\n                stat.unique_users.add(entry.user_id);\n                stat.total_calories += calories;\n                stat.entry_count++;\n            });\n            dailyAggregatedStats = Array.from(statsByDate.values()).map((stat)=>({\n                    date: stat.date,\n                    total_entries: stat.total_entries,\n                    unique_users: stat.unique_users.size,\n                    avg_calories: stat.entry_count > 0 ? stat.total_calories / stat.entry_count : 0\n                })).sort((a, b)=>b.date.localeCompare(a.date));\n        } else {\n            dailyAggregatedStats = dailyStats;\n        }\n        // Query 2: Meal type distribution\n        const { data: mealTypeData, error: mealTypeError } = await supabase.from(\"food_entries\").select(\"meal_type\");\n        if (mealTypeError) throw mealTypeError;\n        const mealTypeCounts = new Map();\n        let totalWithMealType = 0;\n        mealTypeData?.forEach((entry)=>{\n            if (entry.meal_type) {\n                mealTypeCounts.set(entry.meal_type, (mealTypeCounts.get(entry.meal_type) || 0) + 1);\n                totalWithMealType++;\n            }\n        });\n        const mealTypeDistribution = Array.from(mealTypeCounts.entries()).map(([meal_type, count])=>({\n                meal_type,\n                count,\n                percentage: totalWithMealType > 0 ? Math.round(count / totalWithMealType * 100 * 100) / 100 : 0\n            })).sort((a, b)=>b.count - a.count);\n        // Query 3: Average nutrition per entry\n        const { data: allEntries, error: nutritionError } = await supabase.from(\"food_entries\").select(\"nutritional_data\");\n        if (nutritionError) throw nutritionError;\n        let totalCalories = 0;\n        let totalProtein = 0;\n        let totalCarbs = 0;\n        let totalFat = 0;\n        let entryCount = 0;\n        allEntries?.forEach((entry)=>{\n            const nutrition = entry.nutritional_data || {};\n            totalCalories += parseFloat(nutrition.calories || \"0\");\n            totalProtein += parseFloat(nutrition.protein || \"0\");\n            totalCarbs += parseFloat(nutrition.carbohydrates || \"0\");\n            totalFat += parseFloat(nutrition.fat || \"0\");\n            entryCount++;\n        });\n        const averageNutrition = {\n            avg_calories: entryCount > 0 ? totalCalories / entryCount : 0,\n            avg_protein: entryCount > 0 ? totalProtein / entryCount : 0,\n            avg_carbs: entryCount > 0 ? totalCarbs / entryCount : 0,\n            avg_fat: entryCount > 0 ? totalFat / entryCount : 0\n        };\n        // Get overall statistics\n        const { count: totalEntries, error: countError } = await supabase.from(\"food_entries\").select(\"*\", {\n            count: \"exact\",\n            head: true\n        });\n        if (countError) throw countError;\n        const { data: uniqueUsersData, error: usersError } = await supabase.from(\"food_entries\").select(\"user_id\");\n        if (usersError) throw usersError;\n        const uniqueUsers = new Set(uniqueUsersData?.map((e)=>e.user_id) || []);\n        return next_server__WEBPACK_IMPORTED_MODULE_1__.NextResponse.json({\n            summary: {\n                total_entries: totalEntries || 0,\n                unique_users: uniqueUsers.size\n            },\n            daily_stats: dailyAggregatedStats,\n            meal_type_distribution: mealTypeDistribution,\n            average_nutrition: averageNutrition\n        });\n    } catch (error) {\n        console.error(\"Error fetching admin statistics:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_1__.NextResponse.json({\n            error: error.message || \"Failed to fetch statistics\"\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvYXBwL2FwaS9hZG1pbi9zdGF0aXN0aWNzL3JvdXRlLnRzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUF5RDtBQUNEO0FBRXhEOzs7O0NBSUMsR0FDTSxlQUFlRSxJQUFJQyxPQUFvQjtJQUM1QyxJQUFJO1FBQ0YsMEJBQTBCO1FBQzFCLE1BQU1DLGFBQWFELFFBQVFFLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDO1FBQ3ZDLE1BQU1DLGNBQWNDLFFBQVFDLEdBQUcsQ0FBQ0MsYUFBYTtRQUU3QyxJQUFJLENBQUNILGFBQWE7WUFDaEIsT0FBT04scURBQVlBLENBQUNVLElBQUksQ0FDdEI7Z0JBQUVDLE9BQU87WUFBK0IsR0FDeEM7Z0JBQUVDLFFBQVE7WUFBSTtRQUVsQjtRQUVBLHVCQUF1QjtRQUN2QixJQUFJLENBQUNULGNBQWNBLGVBQWUsQ0FBQyxPQUFPLEVBQUVHLFlBQVksQ0FBQyxFQUFFO1lBQ3pELE9BQU9OLHFEQUFZQSxDQUFDVSxJQUFJLENBQ3RCO2dCQUFFQyxPQUFPO1lBQXVDLEdBQ2hEO2dCQUFFQyxRQUFRO1lBQUk7UUFFbEI7UUFFQSxNQUFNQyxXQUFXZCxzRUFBaUJBO1FBRWxDLCtDQUErQztRQUMvQyxNQUFNLEVBQUVlLE1BQU1DLFVBQVUsRUFBRUosT0FBT0ssVUFBVSxFQUFFLEdBQUcsTUFBTUgsU0FBU0ksR0FBRyxDQUFDO1FBRW5FLHlDQUF5QztRQUN6QyxJQUFJQztRQUNKLElBQUlGLFlBQVk7WUFDZCxNQUFNLEVBQUVGLElBQUksRUFBRUgsS0FBSyxFQUFFLEdBQUcsTUFBTUUsU0FDM0JNLElBQUksQ0FBQyxnQkFDTEMsTUFBTSxDQUFDO1lBRVYsSUFBSVQsT0FBTyxNQUFNQTtZQUVqQiwyQ0FBMkM7WUFDM0MsTUFBTVUsY0FBYyxJQUFJQztZQVF4QlIsTUFBTVMsUUFBUSxDQUFDQztnQkFDYixNQUFNQyxPQUFPLElBQUlDLEtBQUtGLE1BQU1HLFNBQVMsRUFBRUMsV0FBVyxHQUFHQyxLQUFLLENBQUMsSUFBSSxDQUFDLEVB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QUFhO1lBQzVETSxhQUFhTixhQUFhLElBQUlILGVBQWVHLGFBQWE7WUFDMURPLFdBQVdQLGFBQWEsSUFBSUYsYUFBYUUsYUFBYTtZQUN0RFEsU0FBU1IsYUFBYSxJQUFJRCxXQUFXQyxhQUFhO1FBQ3BEO1FBRUEseUJBQXlCO1FBQ3pCLE1BQU0sRUFBRVYsT0FBT21CLFlBQVksRUFBRW5FLE9BQU9vRSxVQUFVLEVBQUUsR0FBRyxNQUFNbEUsU0FDdERNLElBQUksQ0FBQyxnQkFDTEMsTUFBTSxDQUFDLEtBQUs7WUFBRXVDLE9BQU87WUFBU3FCLE1BQU07UUFBSztRQUU1QyxJQUFJRCxZQUFZLE1BQU1BO1FBRXRCLE1BQU0sRUFBRWpFLE1BQU1tRSxlQUFlLEVBQUV0RSxPQUFPdUUsVUFBVSxFQUFFLEdBQUcsTUFBTXJFLFNBQ3hETSxJQUFJLENBQUMsZ0JBQ0xDLE1BQU0sQ0FBQztRQUVWLElBQUk4RCxZQUFZLE1BQU1BO1FBRXRCLE1BQU1DLGNBQWMsSUFBSTlDLElBQUk0QyxpQkFBaUJwQyxJQUFJLENBQUN1QyxJQUFXQSxFQUFFMUMsT0FBTyxLQUFLLEVBQUU7UUFFN0UsT0FBTzFDLHFEQUFZQSxDQUFDVSxJQUFJLENBQUM7WUFDdkIyRSxTQUFTO2dCQUNQbEQsZUFBZTJDLGdCQUFnQjtnQkFDL0IxQyxjQUFjK0MsWUFBWXJDLElBQUk7WUFDaEM7WUFDQXdDLGFBQWFwRTtZQUNicUUsd0JBQXdCOUI7WUFDeEIrQixtQkFBbUJkO1FBQ3JCO0lBQ0YsRUFBRSxPQUFPL0QsT0FBWTtRQUNuQjhFLFFBQVE5RSxLQUFLLENBQUMsb0NBQW9DQTtRQUNsRCxPQUFPWCxxREFBWUEsQ0FBQ1UsSUFBSSxDQUN0QjtZQUFFQyxPQUFPQSxNQUFNK0UsT0FBTyxJQUFJO1FBQTZCLEdBQ3ZEO1lBQUU5RSxRQUFRO1FBQUk7SUFFbEI7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL2FmaXJkLWZvb2QtdHJhY2tlci8uL3NyYy9hcHAvYXBpL2FkbWluL3N0YXRpc3RpY3Mvcm91dGUudHM/ODhkYyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBjcmVhdGVBZG1pbkNsaWVudCB9IGZyb20gJ0AvbGliL3N1cGFiYXNlL2FkbWluJztcbmltcG9ydCB7IE5leHRSZXF1ZXN0LCBOZXh0UmVzcG9uc2UgfSBmcm9tICduZXh0L3NlcnZlcic7XG5cbi8qKlxuICogQWRtaW4gc3RhdGlzdGljcyBBUEkgZW5kcG9pbnRcbiAqIFJldHVybnMgYWdncmVnYXRlZCBhbm9ueW1pemVkIHN0YXRpc3RpY3MgYWNyb3NzIGFsbCB1c2Vyc1xuICogUHJvdGVjdGVkIGJ5IEFETUlOX0FQSV9LRVkgZW52aXJvbm1lbnQgdmFyaWFibGVcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIEdFVChyZXF1ZXN0OiBOZXh0UmVxdWVzdCkge1xuICB0cnkge1xuICAgIC8vIENoZWNrIGZvciBhZG1pbiBBUEkga2V5XG4gICAgY29uc3QgYXV0aEhlYWRlciA9IHJlcXVlc3QuaGVhZGVycy5nZXQoJ2F1dGhvcml6YXRpb24nKTtcbiAgICBjb25zdCBhZG1pbkFwaUtleSA9IHByb2Nlc3MuZW52LkFETUlOX0FQSV9LRVk7XG4gICAgXG4gICAgaWYgKCFhZG1pbkFwaUtleSkge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgICB7IGVycm9yOiAnQWRtaW4gQVBJIGtleSBub3QgY29uZmlndXJlZCcgfSxcbiAgICAgICAgeyBzdGF0dXM6IDUwMCB9XG4gICAgICApO1xuICAgIH1cblxuICAgIC8vIFZlcmlmeSBhZG1pbiBBUEkga2V5XG4gICAgaWYgKCFhdXRoSGVhZGVyIHx8IGF1dGhIZWFkZXIgIT09IGBCZWFyZXIgJHthZG1pbkFwaUtleX1gKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHsgZXJyb3I6ICdVbmF1dGhvcml6ZWQgLSBJbnZhbGlkIGFkbWluIEFQSSBrZXknIH0sXG4gICAgICAgIHsgc3RhdHVzOiA0MDEgfVxuICAgICAgKTtcbiAgICB9XG5cbiAgICBjb25zdCBzdXBhYmFzZSA9IGNyZWF0ZUFkbWluQ2xpZW50KCk7XG5cbiAgICAvLyBRdWVyeSAxOiBEYWlseSBhZ2dyZWdhdGVkIHN0YXRzIChhbm9ueW1pemVkKVxuICAgIGNvbnN0IHsgZGF0YTogZGFpbHlTdGF0cywgZXJyb3I6IGRhaWx5RXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlLnJwYygnZ2V0X2RhaWx5X3N0YXRzJyk7XG4gICAgXG4gICAgLy8gSWYgUlBDIGRvZXNuJ3QgZXhpc3QsIHVzZSBkaXJlY3QgcXVlcnlcbiAgICBsZXQgZGFpbHlBZ2dyZWdhdGVkU3RhdHM7XG4gICAgaWYgKGRhaWx5RXJyb3IpIHtcbiAgICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAgIC5mcm9tKCdmb29kX2VudHJpZXMnKVxuICAgICAgICAuc2VsZWN0KCdkYXRlX3RpbWUsIG51dHJpdGlvbmFsX2RhdGEsIHVzZXJfaWQnKTtcbiAgICAgIFxuICAgICAgaWYgKGVycm9yKSB0aHJvdyBlcnJvcjtcbiAgICAgIFxuICAgICAgLy8gUHJvY2VzcyBpbiBtZW1vcnkgKGZvciBzbWFsbGVyIGRhdGFzZXRzKVxuICAgICAgY29uc3Qgc3RhdHNCeURhdGUgPSBuZXcgTWFwPHN0cmluZywge1xuICAgICAgICBkYXRlOiBzdHJpbmc7XG4gICAgICAgIHRvdGFsX2VudHJpZXM6IG51bWJlcjtcbiAgICAgICAgdW5pcXVlX3VzZXJzOiBTZXQ8c3RyaW5nPjtcbiAgICAgICAgdG90YWxfY2Fsb3JpZXM6IG51bWJlcjtcbiAgICAgICAgZW50cnlfY291bnQ6IG51bWJlcjtcbiAgICAgIH0+KCk7XG5cbiAgICAgIGRhdGE/LmZvckVhY2goKGVudHJ5OiBhbnkpID0+IHtcbiAgICAgICAgY29uc3QgZGF0ZSA9IG5ldyBEYXRlKGVudHJ5LmRhdGVfdGltZSkudG9JU09TdHJpbmcoKS5zcGxpdCgnVCcpWzBdO1xuICAgICAgICBjb25zdCBjYWxvcmllcyA9IHBhcnNlRmxvYXQoZW50cnkubnV0cml0aW9uYWxfZGF0YT8uY2Fsb3JpZXMgfHwgJzAnKTtcbiAgICAgICAgXG4gICAgICAgIGlmICghc3RhdHNCeURhdGUuaGFzKGRhdGUpKSB7XG4gICAgICAgICAgc3RhdHNCeURhdGUuc2V0KGRhdGUsIHtcbiAgICAgICAgICAgIGRhdGUsXG4gICAgICAgICAgICB0b3RhbF9lbnRyaWVzOiAwLFxuICAgICAgICAgICAgdW5pcXVlX3VzZXJzOiBuZXcgU2V0KCksXG4gICAgICAgICAgICB0b3RhbF9jYWxvcmllczogMCxcbiAgICAgICAgICAgIGVudHJ5X2NvdW50OiAwLFxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBjb25zdCBzdGF0ID0gc3RhdHNCeURhdGUuZ2V0KGRhdGUpITtcbiAgICAgICAgc3RhdC50b3RhbF9lbnRyaWVzKys7XG4gICAgICAgIHN0YXQudW5pcXVlX3VzZXJzLmFkZChlbnRyeS51c2VyX2lkKTtcbiAgICAgICAgc3RhdC50b3RhbF9jYWxvcmllcyArPSBjYWxvcmllcztcbiAgICAgICAgc3RhdC5lbnRyeV9jb3VudCsrO1xuICAgICAgfSk7XG5cbiAgICAgIGRhaWx5QWdncmVnYXRlZFN0YXRzID0gQXJyYXkuZnJvbShzdGF0c0J5RGF0ZS52YWx1ZXMoKSlcbiAgICAgICAgLm1hcChzdGF0ID0+ICh7XG4gICAgICAgICAgZGF0ZTogc3RhdC5kYXRlLFxuICAgICAgICAgIHRvdGFsX2VudHJpZXM6IHN0YXQudG90YWxfZW50cmllcyxcbiAgICAgICAgICB1bmlxdWVfdXNlcnM6IHN0YXQudW5pcXVlX3VzZXJzLnNpemUsXG4gICAgICAgICAgYXZnX2NhbG9yaWVzOiBzdGF0LmVudHJ5X2NvdW50ID4gMCA/IHN0YXQudG90YWxfY2Fsb3JpZXMgLyBzdGF0LmVudHJ5X2NvdW50IDogMCxcbiAgICAgICAgfSkpXG4gICAgICAgIC5zb3J0KChhLCBiKSA9PiBiLmRhdGUubG9jYWxlQ29tcGFyZShhLmRhdGUpKTtcbiAgICB9IGVsc2Uge1xuICAgICAgZGFpbHlBZ2dyZWdhdGVkU3RhdHMgPSBkYWlseVN0YXRzO1xuICAgIH1cblxuICAgIC8vIFF1ZXJ5IDI6IE1lYWwgdHlwZSBkaXN0cmlidXRpb25cbiAgICBjb25zdCB7IGRhdGE6IG1lYWxUeXBlRGF0YSwgZXJyb3I6IG1lYWxUeXBlRXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAuZnJvbSgnZm9vZF9lbnRyaWVzJylcbiAgICAgIC5zZWxlY3QoJ21lYWxfdHlwZScpO1xuXG4gICAgaWYgKG1lYWxUeXBlRXJyb3IpIHRocm93IG1lYWxUeXBlRXJyb3I7XG5cbiAgICBjb25zdCBtZWFsVHlwZUNvdW50cyA9IG5ldyBNYXA8c3RyaW5nLCBudW1iZXI+KCk7XG4gICAgbGV0IHRvdGFsV2l0aE1lYWxUeXBlID0gMDtcblxuICAgIG1lYWxUeXBlRGF0YT8uZm9yRWFjaCgoZW50cnk6IGFueSkgPT4ge1xuICAgICAgaWYgKGVudHJ5Lm1lYWxfdHlwZSkge1xuICAgICAgICBtZWFsVHlwZUNvdW50cy5zZXQoXG4gICAgICAgICAgZW50cnkubWVhbF90eXBlLFxuICAgICAgICAgIChtZWFsVHlwZUNvdW50cy5nZXQoZW50cnkubWVhbF90eXBlKSB8fCAwKSArIDFcbiAgICAgICAgKTtcbiAgICAgICAgdG90YWxXaXRoTWVhbFR5cGUrKztcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGNvbnN0IG1lYWxUeXBlRGlzdHJpYnV0aW9uID0gQXJyYXkuZnJvbShtZWFsVHlwZUNvdW50cy5lbnRyaWVzKCkpXG4gICAgICAubWFwKChbbWVhbF90eXBlLCBjb3VudF0pID0+ICh7XG4gICAgICAgIG1lYWxfdHlwZSxcbiAgICAgICAgY291bnQsXG4gICAgICAgIHBlcmNlbnRhZ2U6IHRvdGFsV2l0aE1lYWxUeXBlID4gMFxuICAgICAgICAgID8gTWF0aC5yb3VuZCgoY291bnQgLyB0b3RhbFdpdGhNZWFsVHlwZSkgKiAxMDAgKiAxMDApIC8gMTAwXG4gICAgICAgICAgOiAwLFxuICAgICAgfSkpXG4gICAgICAuc29ydCgoYSwgYikgPT4gYi5jb3VudCAtIGEuY291bnQpO1xuXG4gICAgLy8gUXVlcnkgMzogQXZlcmFnZSBudXRyaXRpb24gcGVyIGVudHJ5XG4gICAgY29uc3QgeyBkYXRhOiBhbGxFbnRyaWVzLCBlcnJvcjogbnV0cml0aW9uRXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAuZnJvbSgnZm9vZF9lbnRyaWVzJylcbiAgICAgIC5zZWxlY3QoJ251dHJpdGlvbmFsX2RhdGEnKTtcblxuICAgIGlmIChudXRyaXRpb25FcnJvcikgdGhyb3cgbnV0cml0aW9uRXJyb3I7XG5cbiAgICBsZXQgdG90YWxDYWxvcmllcyA9IDA7XG4gICAgbGV0IHRvdGFsUHJvdGVpbiA9IDA7XG4gICAgbGV0IHRvdGFsQ2FyYnMgPSAwO1xuICAgIGxldCB0b3RhbEZhdCA9IDA7XG4gICAgbGV0IGVudHJ5Q291bnQgPSAwO1xuXG4gICAgYWxsRW50cmllcz8uZm9yRWFjaCgoZW50cnk6IGFueSkgPT4ge1xuICAgICAgY29uc3QgbnV0cml0aW9uID0gZW50cnkubnV0cml0aW9uYWxfZGF0YSB8fCB7fTtcbiAgICAgIHRvdGFsQ2Fsb3JpZXMgKz0gcGFyc2VGbG9hdChudXRyaXRpb24uY2Fsb3JpZXMgfHwgJzAnKTtcbiAgICAgIHRvdGFsUHJvdGVpbiArPSBwYXJzZUZsb2F0KG51dHJpdGlvbi5wcm90ZWluIHx8ICcwJyk7XG4gICAgICB0b3RhbENhcmJzICs9IHBhcnNlRmxvYXQobnV0cml0aW9uLmNhcmJvaHlkcmF0ZXMgfHwgJzAnKTtcbiAgICAgIHRvdGFsRmF0ICs9IHBhcnNlRmxvYXQobnV0cml0aW9uLmZhdCB8fCAnMCcpO1xuICAgICAgZW50cnlDb3VudCsrO1xuICAgIH0pO1xuXG4gICAgY29uc3QgYXZlcmFnZU51dHJpdGlvbiA9IHtcbiAgICAgIGF2Z19jYWxvcmllczogZW50cnlDb3VudCA+IDAgPyB0b3RhbENhbG9yaWVzIC8gZW50cnlDb3VudCA6IDAsXG4gICAgICBhdmdfcHJvdGVpbjogZW50cnlDb3VudCA+IDAgPyB0b3RhbFByb3RlaW4gLyBlbnRyeUNvdW50IDogMCxcbiAgICAgIGF2Z19jYXJiczogZW50cnlDb3VudCA+IDAgPyB0b3RhbENhcmJzIC8gZW50cnlDb3VudCA6IDAsXG4gICAgICBhdmdfZmF0OiBlbnRyeUNvdW50ID4gMCA/IHRvdGFsRmF0IC8gZW50cnlDb3VudCA6IDAsXG4gICAgfTtcblxuICAgIC8vIEdldCBvdmVyYWxsIHN0YXRpc3RpY3NcbiAgICBjb25zdCB7IGNvdW50OiB0b3RhbEVudHJpZXMsIGVycm9yOiBjb3VudEVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgLmZyb20oJ2Zvb2RfZW50cmllcycpXG4gICAgICAuc2VsZWN0KCcqJywgeyBjb3VudDogJ2V4YWN0JywgaGVhZDogdHJ1ZSB9KTtcblxuICAgIGlmIChjb3VudEVycm9yKSB0aHJvdyBjb3VudEVycm9yO1xuXG4gICAgY29uc3QgeyBkYXRhOiB1bmlxdWVVc2Vyc0RhdGEsIGVycm9yOiB1c2Vyc0Vycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgLmZyb20oJ2Zvb2RfZW50cmllcycpXG4gICAgICAuc2VsZWN0KCd1c2VyX2lkJyk7XG5cbiAgICBpZiAodXNlcnNFcnJvcikgdGhyb3cgdXNlcnNFcnJvcjtcblxuICAgIGNvbnN0IHVuaXF1ZVVzZXJzID0gbmV3IFNldCh1bmlxdWVVc2Vyc0RhdGE/Lm1hcCgoZTogYW55KSA9PiBlLnVzZXJfaWQpIHx8IFtdKTtcblxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7XG4gICAgICBzdW1tYXJ5OiB7XG4gICAgICAgIHRvdGFsX2VudHJpZXM6IHRvdGFsRW50cmllcyB8fCAwLFxuICAgICAgICB1bmlxdWVfdXNlcnM6IHVuaXF1ZVVzZXJzLnNpemUsXG4gICAgICB9LFxuICAgICAgZGFpbHlfc3RhdHM6IGRhaWx5QWdncmVnYXRlZFN0YXRzLFxuICAgICAgbWVhbF90eXBlX2Rpc3RyaWJ1dGlvbjogbWVhbFR5cGVEaXN0cmlidXRpb24sXG4gICAgICBhdmVyYWdlX251dHJpdGlvbjogYXZlcmFnZU51dHJpdGlvbixcbiAgICB9KTtcbiAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIGFkbWluIHN0YXRpc3RpY3M6JywgZXJyb3IpO1xuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgIHsgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfHwgJ0ZhaWxlZCB0byBmZXRjaCBzdGF0aXN0aWNzJyB9LFxuICAgICAgeyBzdGF0dXM6IDUwMCB9XG4gICAgKTtcbiAgfVxufVxuXG4iXSwibmFtZXMiOlsiY3JlYXRlQWRtaW5DbGllbnQiLCJOZXh0UmVzcG9uc2UiLCJHRVQiLCJyZXF1ZXN0IiwiYXV0aEhlYWRlciIsImhlYWRlcnMiLCJnZXQiLCJhZG1pbkFwaUtleSIsInByb2Nlc3MiLCJlbnYiLCJBRE1JTl9BUElfS0VZIiwianNvbiIsImVycm9yIiwic3RhdHVzIiwic3VwYWJhc2UiLCJkYXRhIiwiZGFpbHlTdGF0cyIsImRhaWx5RXJyb3IiLCJycGMiLCJkYWlseUFnZ3JlZ2F0ZWRTdGF0cyIsImZyb20iLCJzZWxlY3QiLCJzdGF0c0J5RGF0ZSIsIk1hcCIsImZvckVhY2giLCJlbnRyeSIsImRhdGUiLCJEYXRlIiwiZGF0ZV90aW1lIiwidG9JU09TdHJpbmciLCJzcGxpdCIsImNhbG9yaWVzIiwicGFyc2VGbG9hdCIsIm51dHJpdGlvbmFsX2RhdGEiLCJoYXMiLCJzZXQiLCJ0b3RhbF9lbnRyaWVzIiwidW5pcXVlX3VzZXJzIiwiU2V0IiwidG90YWxfY2Fsb3JpZXMiLCJlbnRyeV9jb3VudCIsInN0YXQiLCJhZGQiLCJ1c2VyX2lkIiwiQXJyYXkiLCJ2YWx1ZXMiLCJtYXAiLCJzaXplIiwiYXZnX2NhbG9yaWVzIiwic29ydCIsImEiLCJiIiwibG9jYWxlQ29tcGFyZSIsIm1lYWxUeXBlRGF0YSIsIm1lYWxUeXBlRXJyb3IiLCJtZWFsVHlwZUNvdW50cyIsInRvdGFsV2l0aE1lYWxUeXBlIiwibWVhbF90eXBlIiwibWVhbFR5cGVEaXN0cmlidXRpb24iLCJlbnRyaWVzIiwiY291bnQiLCJwZXJjZW50YWdlIiwiTWF0aCIsInJvdW5kIiwiYWxsRW50cmllcyIsIm51dHJpdGlvbkVycm9yIiwidG90YWxDYWxvcmllcyIsInRvdGFsUHJvdGVpbiIsInRvdGFsQ2FyYnMiLCJ0b3RhbEZhdCIsImVudHJ5Q291bnQiLCJudXRyaXRpb24iLCJwcm90ZWluIiwiY2FyYm9oeWRyYXRlcyIsImZhdCIsImF2ZXJhZ2VOdXRyaXRpb24iLCJhdmdfcHJvdGVpbiIsImF2Z19jYXJicyIsImF2Z19mYXQiLCJ0b3RhbEVudHJpZXMiLCJjb3VudEVycm9yIiwiaGVhZCIsInVuaXF1ZVVzZXJzRGF0YSIsInVzZXJzRXJyb3IiLCJ1bmlxdWVVc2VycyIsImUiLCJzdW1tYXJ5IiwiZGFpbHlfc3RhdHMiLCJtZWFsX3R5cGVfZGlzdHJpYnV0aW9uIiwiYXZlcmFnZV9udXRyaXRpb24iLCJjb25zb2xlIiwibWVzc2FnZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/admin/statistics/route.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/supabase/admin.ts":
/*!***********************************!*\
  !*** ./src/lib/supabase/admin.ts ***!
  \***********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createAdminClient: () => (/* binding */ createAdminClient)\n/* harmony export */ });\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @supabase/supabase-js */ \"(rsc)/./node_modules/@supabase/supabase-js/dist/index.mjs\");\n\n/**\n * Admin client with service role key\n * Only use this in server-side API routes\n * Never expose this key to the client\n */ function createAdminClient() {\n    const supabaseUrl = \"https://migwxtovyxygobpmhuqk.supabase.co\";\n    const supabaseServiceKey = process.env.SUPABASE_SERVICE_ROLE_KEY;\n    if (!supabaseUrl || !supabaseServiceKey) {\n        throw new Error(\"Missing Supabase environment variables\");\n    }\n    return (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__.createClient)(supabaseUrl, supabaseServiceKey, {\n        auth: {\n            autoRefreshToken: false,\n            persistSession: false\n        }\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL3N1cGFiYXNlL2FkbWluLnRzIiwibWFwcGluZ3MiOiI7Ozs7O0FBQXFEO0FBRXJEOzs7O0NBSUMsR0FDTSxTQUFTQztJQUNkLE1BQU1DLGNBQWNDLDBDQUFvQztJQUN4RCxNQUFNRyxxQkFBcUJILFFBQVFDLEdBQUcsQ0FBQ0cseUJBQXlCO0lBRWhFLElBQUksQ0FBQ0wsZUFBZSxDQUFDSSxvQkFBb0I7UUFDdkMsTUFBTSxJQUFJRSxNQUFNO0lBQ2xCO0lBRUEsT0FBT1IsbUVBQVlBLENBQUNFLGFBQWFJLG9CQUFvQjtRQUNuREcsTUFBTTtZQUNKQyxrQkFBa0I7WUFDbEJDLGdCQUFnQjtRQUNsQjtJQUNGO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9hZmlyZC1mb29kLXRyYWNrZXIvLi9zcmMvbGliL3N1cGFiYXNlL2FkbWluLnRzPzJmOGQiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgY3JlYXRlQ2xpZW50IH0gZnJvbSAnQHN1cGFiYXNlL3N1cGFiYXNlLWpzJztcblxuLyoqXG4gKiBBZG1pbiBjbGllbnQgd2l0aCBzZXJ2aWNlIHJvbGUga2V5XG4gKiBPbmx5IHVzZSB0aGlzIGluIHNlcnZlci1zaWRlIEFQSSByb3V0ZXNcbiAqIE5ldmVyIGV4cG9zZSB0aGlzIGtleSB0byB0aGUgY2xpZW50XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVBZG1pbkNsaWVudCgpIHtcbiAgY29uc3Qgc3VwYWJhc2VVcmwgPSBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkwhO1xuICBjb25zdCBzdXBhYmFzZVNlcnZpY2VLZXkgPSBwcm9jZXNzLmVudi5TVVBBQkFTRV9TRVJWSUNFX1JPTEVfS0VZITtcblxuICBpZiAoIXN1cGFiYXNlVXJsIHx8ICFzdXBhYmFzZVNlcnZpY2VLZXkpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgU3VwYWJhc2UgZW52aXJvbm1lbnQgdmFyaWFibGVzJyk7XG4gIH1cblxuICByZXR1cm4gY3JlYXRlQ2xpZW50KHN1cGFiYXNlVXJsLCBzdXBhYmFzZVNlcnZpY2VLZXksIHtcbiAgICBhdXRoOiB7XG4gICAgICBhdXRvUmVmcmVzaFRva2VuOiBmYWxzZSxcbiAgICAgIHBlcnNpc3RTZXNzaW9uOiBmYWxzZSxcbiAgICB9LFxuICB9KTtcbn1cblxuIl0sIm5hbWVzIjpbImNyZWF0ZUNsaWVudCIsImNyZWF0ZUFkbWluQ2xpZW50Iiwic3VwYWJhc2VVcmwiLCJwcm9jZXNzIiwiZW52IiwiTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMIiwic3VwYWJhc2VTZXJ2aWNlS2V5IiwiU1VQQUJBU0VfU0VSVklDRV9ST0xFX0tFWSIsIkVycm9yIiwiYXV0aCIsImF1dG9SZWZyZXNoVG9rZW4iLCJwZXJzaXN0U2Vzc2lvbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/supabase/admin.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/@supabase","vendor-chunks/next","vendor-chunks/tslib","vendor-chunks/iceberg-js"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fadmin%2Fstatistics%2Froute&page=%2Fapi%2Fadmin%2Fstatistics%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fadmin%2Fstatistics%2Froute.ts&appDir=%2FUsers%2Fodet%2Fwebsites%2FAFIRD-new%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fodet%2Fwebsites%2FAFIRD-new&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();