(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[811],{1127:function(e,t,a){Promise.resolve().then(a.bind(a,8090))},8090:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return o}});var n=a(7437),s=a(2265),i=a(893),r=a(7041),l=a(8404);function o(){let[e,t]=(0,s.useState)("all"),{entries:a,loading:o,error:d,deleteEntry:c}=(0,l.J)(),u=async e=>{if(confirm("Are you sure you want to delete this entry?"))try{await c(e)}catch(e){alert("Failed to delete entry")}},h="all"===e?a:a.filter(t=>t.meal_type===e);return(0,n.jsx)(i.default,{children:(0,n.jsx)("div",{className:"min-h-screen bg-gray-50",children:(0,n.jsxs)("div",{className:"container mx-auto px-4 py-8 max-w-4xl",children:[(0,n.jsxs)("div",{className:"mb-6",children:[(0,n.jsx)("h1",{className:"text-3xl font-bold text-gray-800 mb-4",children:"Food History"}),(0,n.jsxs)("div",{className:"flex gap-2 mb-4",children:[(0,n.jsx)("button",{onClick:()=>t("all"),className:"px-4 py-2 rounded-lg text-sm font-medium transition ".concat("all"===e?"bg-blue-500 text-white":"bg-white text-gray-700 hover:bg-gray-100"),children:"All"}),(0,n.jsx)("button",{onClick:()=>t("breakfast"),className:"px-4 py-2 rounded-lg text-sm font-medium transition ".concat("breakfast"===e?"bg-blue-500 text-white":"bg-white text-gray-700 hover:bg-gray-100"),children:"Breakfast"}),(0,n.jsx)("button",{onClick:()=>t("lunch"),className:"px-4 py-2 rounded-lg text-sm font-medium transition ".concat("lunch"===e?"bg-blue-500 text-white":"bg-white text-gray-700 hover:bg-gray-100"),children:"Lunch"}),(0,n.jsx)("button",{onClick:()=>t("dinner"),className:"px-4 py-2 rounded-lg text-sm font-medium transition ".concat("dinner"===e?"bg-blue-500 text-white":"bg-white text-gray-700 hover:bg-gray-100"),children:"Dinner"}),(0,n.jsx)("button",{onClick:()=>t("snack"),className:"px-4 py-2 rounded-lg text-sm font-medium transition ".concat("snack"===e?"bg-blue-500 text-white":"bg-white text-gray-700 hover:bg-gray-100"),children:"Snack"})]})]}),o&&(0,n.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,n.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})}),d&&(0,n.jsx)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-lg mb-4",children:d}),!o&&!d&&(0,n.jsxs)("div",{children:[(0,n.jsxs)("p",{className:"text-sm text-gray-600 mb-4",children:["Showing ",h.length," ",1===h.length?"entry":"entries"]}),(0,n.jsx)(r.Z,{entries:h,onDelete:u,showDelete:!0})]})]})})})}},893:function(e,t,a){"use strict";a.d(t,{default:function(){return l}});var n=a(7437),s=a(2265),i=a(9376),r=a(5632);function l(e){let{children:t,redirectTo:a="/login"}=e,{user:l,loading:o}=(0,r.a)(),d=(0,i.useRouter)();return((0,s.useEffect)(()=>{o||l||d.push(a)},[l,o,d,a]),o)?(0,n.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,n.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})}):l?(0,n.jsx)(n.Fragment,{children:t}):null}},7041:function(e,t,a){"use strict";a.d(t,{Z:function(){return i}});var n=a(7437);a(2265);var s=a(8057);function i(e){let{entries:t,onDelete:a,showDelete:i=!1}=e;return 0===t.length?(0,n.jsxs)("div",{className:"text-center py-12",children:[(0,n.jsx)("p",{className:"text-gray-500 text-lg",children:"No food entries yet"}),(0,n.jsx)("p",{className:"text-gray-400 text-sm mt-2",children:"Start by taking a photo of your food!"})]}):(0,n.jsx)("div",{className:"space-y-4",children:t.map(e=>(0,n.jsx)("div",{className:"bg-white rounded-xl shadow-md overflow-hidden hover:shadow-lg transition",children:(0,n.jsxs)("div",{className:"flex",children:[(0,n.jsx)("div",{className:"w-32 h-32 flex-shrink-0 relative",children:(0,n.jsx)("img",{src:e.image_url,alt:"Food",className:"w-full h-full object-cover"})}),(0,n.jsx)("div",{className:"flex-1 p-4",children:(0,n.jsxs)("div",{className:"flex justify-between items-start",children:[(0,n.jsxs)("div",{className:"flex-1",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[e.meal_type&&(0,n.jsx)("span",{className:"px-2 py-1 bg-blue-100 text-blue-700 text-xs font-semibold rounded capitalize",children:e.meal_type}),(0,n.jsx)("span",{className:"text-sm text-gray-500",children:(0,s.o0)(new Date(e.date_time))})]}),e.nutritional_data.food_items&&e.nutritional_data.food_items.length>0&&(0,n.jsx)("p",{className:"text-sm text-gray-600 mb-2",children:e.nutritional_data.food_items.join(", ")}),(0,n.jsxs)("div",{className:"flex gap-4 text-sm",children:[void 0!==e.nutritional_data.calories&&(0,n.jsxs)("span",{className:"text-gray-700",children:[(0,n.jsx)("span",{className:"font-semibold",children:e.nutritional_data.calories.toFixed(0)})," kcal"]}),void 0!==e.nutritional_data.protein&&(0,n.jsxs)("span",{className:"text-gray-700",children:[(0,n.jsxs)("span",{className:"font-semibold",children:[e.nutritional_data.protein.toFixed(1),"g"]})," protein"]}),void 0!==e.nutritional_data.carbohydrates&&(0,n.jsxs)("span",{className:"text-gray-700",children:[(0,n.jsxs)("span",{className:"font-semibold",children:[e.nutritional_data.carbohydrates.toFixed(1),"g"]})," carbs"]})]})]}),i&&a&&(0,n.jsx)("button",{onClick:()=>a(e.id),className:"ml-4 px-3 py-1 text-sm text-red-600 hover:bg-red-50 rounded transition",children:"Delete"})]})})]})},e.id))})}},5632:function(e,t,a){"use strict";a.d(t,{a:function(){return r}});var n=a(2265),s=a(4033),i=a(9376);function r(){let[e,t]=(0,n.useState)(null),[a,r]=(0,n.useState)(null),[l,o]=(0,n.useState)(!0),d=(0,i.useRouter)(),c=(0,s.createBrowserClient)("https://migwxtovyxygobpmhuqk.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im1pZ3d4dG92eXh5Z29icG1odXFrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjU5MzM2MDgsImV4cCI6MjA4MTUwOTYwOH0.05AiLm3KJCGQnMsLv1ffezeISbzCOeXVrmRUtlC4ysg");return(0,n.useEffect)(()=>{c.auth.getSession().then(e=>{var a;let{data:{session:n}}=e;r(n),t(null!==(a=null==n?void 0:n.user)&&void 0!==a?a:null),o(!1)});let{data:{subscription:e}}=c.auth.onAuthStateChange((e,a)=>{var n;r(a),t(null!==(n=null==a?void 0:a.user)&&void 0!==n?n:null),o(!1)});return()=>e.unsubscribe()},[c]),{user:e,session:a,loading:l,signUp:async(e,t)=>{let{data:a,error:n}=await c.auth.signUp({email:e,password:t});if(n)throw n;return a},signIn:async(e,t)=>{let{data:a,error:n}=await c.auth.signInWithPassword({email:e,password:t});if(n)throw n;return a},signOut:async()=>{let{error:e}=await c.auth.signOut();if(e)throw e;d.push("/login")},isAuthenticated:!!e}}},8404:function(e,t,a){"use strict";a.d(t,{J:function(){return s}});var n=a(2265);function s(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{autoFetch:t=!0,...a}=e,[s,i]=(0,n.useState)([]),[r,l]=(0,n.useState)(t),[o,d]=(0,n.useState)(null),c=(0,n.useCallback)(async()=>{try{l(!0),d(null);let e=new URLSearchParams;a.startDate&&e.append("startDate",a.startDate.toISOString()),a.endDate&&e.append("endDate",a.endDate.toISOString()),a.mealType&&e.append("mealType",a.mealType),a.limit&&e.append("limit",a.limit.toString());let t=await fetch("/api/food-entries?".concat(e.toString()));if(!t.ok)throw Error("Failed to fetch entries");let n=await t.json();i(n.entries||[])}catch(e){d(e.message||"Failed to fetch entries")}finally{l(!1)}},[a.startDate,a.endDate,a.mealType,a.limit]);return(0,n.useEffect)(()=>{t&&c()},[t,c]),{entries:s,loading:r,error:o,fetchEntries:c,saveEntry:async(e,t,a,n)=>{try{l(!0),d(null);let s=new FormData;s.append("image",e),s.append("nutritionalData",JSON.stringify(t)),a&&s.append("mealType",a),s.append("dateTime",(n||new Date).toISOString());let r=await fetch("/api/food-entries",{method:"POST",body:s});if(!r.ok){let e=await r.json();throw Error(e.error||"Failed to save entry")}let o=(await r.json()).entry;return i(e=>[o,...e]),o}catch(e){throw d(e.message||"Failed to save entry"),e}finally{l(!1)}},deleteEntry:async e=>{try{l(!0),d(null);let t=await fetch("/api/food-entries/".concat(e),{method:"DELETE"});if(!t.ok){let e=await t.json();throw Error(e.error||"Failed to delete entry")}i(t=>t.filter(t=>t.id!==e))}catch(e){throw d(e.message||"Failed to delete entry"),e}finally{l(!1)}},refetch:c}}},8057:function(e,t,a){"use strict";a.d(t,{SY:function(){return r},o0:function(){return i}});var n=a(7868),s=a(4081);function i(e){return(0,n.Z)(e,"PPp")}function r(e){return(0,s.Z)(e,{addSuffix:!0})}}},function(e){e.O(0,[146,797,971,117,744],function(){return e(e.s=1127)}),_N_E=e.O()}]);